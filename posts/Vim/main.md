---
Keywords: 
Copyright: (C) Takaaki Yamada
---

# Vimの知見を貯める場所

## 未分類

### .vimrc

```
" 折り返した１行下にカーソルを移動する
nnoremap j gj
nnoremap k gk
```

### ファイルを読取り専用で開く

```
$ vim -R <file>
```

### バッファをすべて更新する

```
:bufdo e
```

### バッファを移動する

```
:ls  # バッファリストを表示する
:bn  # next
:bp  # previous
:bN  # Nはリスト上の番号
```

### マーク

```
# 現在設定されているマークを表示する
:marks

# マークを設定する
# ファイル内でのみ有効（[a-z]は半角英字小文字1字）
m[a-z]

# ファイル間でも有効
# ファイル内でのみ有効（[a-z]は半角英字大文字1字）
m[A-Z]

# 設定されているマーク行の先頭にジャンプする
'[a-z]
'[A-Z]

# 設定されているマークの箇所にジャンプする
`[a-z]
`[A-Z]

# マークまでコピーや削除する
d'[a-z]
y'[a-z]
```

### 検索

| |説明|
|---|---|
|/|前方検索|
|?|後方検索|
|\*|カーソル下の単語を前方検索|
|#|カーソル下の単語を後方検索|

カーソル下の単語の区切り方は、iskeywordオプションで設定できる。hello-worldを１つの単語として扱いたい場合は以下の通りに設定する。
```
:set iskeyword+=-
```
大文字・小文字を無視して検索する（ただし、大文字を入力した時は無視しない）
```
:set ignorecase
:set smartcase
```
一般的な正規表現を使いたい場合は /\v を使う。
```
:h /\v
```
Vim独自の正規表現で範囲指定する場合
```
:h /\%l
```

## ヘルプ

基礎

```
" 画面を垂直に分割してヘルプを開く
:vert h command

" 画面を分割せずにヘルプを開く
:h motion | only

" grep
:helpgrep <string>

" カーソルの下のヘルプタグにジャンプする
Ctrl + ]

" 元の場所に戻る
Ctrl + T
```

```
" オプション
:h options

" オペレーター
:h operator

" 編集
:h change

" マーク
:h mark-motions

" ウィンドウ
:h windows

" タブ
:h tabpage
```

## ウィンドウ

[コマンドラインモードについて学ぼう 〜 Vimはいいぞ！ゴリラと学ぶVim講座(4)](https://knowledge.sakura.ad.jp/22488/)

### ウィンドウの作成

:spとvsは、大きな（例えば1000行以上）ソースファイルの先頭にある処理を確認しつつ、新しい関数を実装するときに使用すると便利。

|コマンド|説明|
|---|---|
|:new {file}|ウィンドウを水平分割（上下に分割）して開く。ファイルを指定しなければ空のウィンドウが開く|
|:vnew {file}|ウィンドウを垂直分割（左右に分割）して開く。ファイルを指定しなければ空のウィンドウが開く|
|:sp {file}|ウィンドウを水平分割（上下に分割）して開く。ファイルを指定しなければ現在のファイルが開く|
|:vs {file}|ウィンドウを垂直分割（左右に分割）して開く。ファイルを指定しなければ現在のファイルが開く|

### ウィンドウ間の移動

|キーマップ|Exコマンド|説明|
|---|---|---|
|[N] CTRL-w j|:wincmd j|[N}個下のウィンドウに移動|
|[N] CTRL-w k|:wincmd k|[N}個上のウィンドウに移動|
|[N] CTRL-w h|:wincmd h|[N}個左のウィンドウに移動|
|[N] CTRL-w l|:wincmd l|[N}個右のウィンドウに移動|
|CTRL-w t|-|一番上のウィンドウに移動|
|CTRL-w b|-|一番下のウィンドウに移動|

## タブ（複数のウィンドウをまとめたもの）

※追記すること

## QuickFix

```
:vimgrep /<pattern>/ <file>
:copen
:cclose
```

## ファイル操作

### ファイルを開く

Vim起動時に複数のファイルを指定すると、引数リストの最初のファイルが開かれる。
```
$ vim *.txt
```
引数リストを操作してファイルを開くことができる。:ls でも操作できる。
```
:args # 引数リストを表示する
:next # 引数リスト上の次へ
:prev # 引数リスト上の前へ
```
ファイルを検索して開く。検索対象のフォルダを path に追加しておくと便利。
```
:set path+=<対象フォルダ>/**
:find main.md
```
ファイル上に記載されているパスのファイルを開く。
```
fg
```

### ファイルへの書き込み

ファイルに上書きする。
```
:w /path/file
```
保存先のフォルダが存在しない場合はVimの関数を呼び出す。
```
:call mkdir('/path/to/directory', 'p')
```
シェルのコマンドを呼び出して作ることもできる。
```
:!mkdir -p /path/to/directory
```
バッファに表示されている内容を別のファイルに追記する。
```
:w >> <別のファイル>
```
ちなみに、リダイレクトのようなことができる。ファイルの内容を wc コマンドにパイプしている。
```
:w !wc
```

## プラグイン

### NERDTree

ツリー上で「?」を入力するとヘルプが表示される。

また、ツリー上で「m」を入力すると、簡易なインタラクティブモードに。

|コマンド|内容|
---|---
|Ctrl+w+w|ツリーとファイル間を順に移動する|
|Ctrl+w+h|左のファイルへ|
|Ctrl+w+j|上のファイルへ|
|Ctrl+w+k|下のファイルへ|
|Ctrl+w+l|右のファイルへ|
